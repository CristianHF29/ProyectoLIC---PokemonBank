<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pokémon Bank — Gráfico</title>

  <!-- Estilos base -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="css/estilo.css" rel="stylesheet">

  <!-- Chart.js para el gráfico -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-body-tertiary" style="font-family: Poppins, system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial">

  <!-- Barra superior con navegación -->
  <header class="border-bottom bg-white">
    <div class="container d-flex align-items-center justify-content-between py-3">
      <div class="d-flex align-items-center gap-3">
        <img src="https://archives.bulbagarden.net/media/upload/thumb/a/a3/Pok%C3%A9mon_Bank_logo.png/800px-Pok%C3%A9mon_Bank_logo.png" alt="Pokémon Bank" style="height:36px">
        <strong>Resumen visual</strong>
      </div>
      <nav class="d-flex align-items-center gap-2">
        <a href="acciones.html" class="btn btn-sm btn-outline-secondary">Acciones</a>
        <a href="historial.html" class="btn btn-sm btn-outline-secondary">Historial</a>
        <a href="index.html" class="btn btn-sm btn-dark">Cerrar sesión</a>
      </nav>
    </div>
  </header>

  <main class="py-4">
    <div class="container">

      <!-- Filtros simples -->
      <section class="mb-3">
        <div class="card border-0 shadow-sm rounded-4">
          <div class="card-body">
            <form class="row g-2 align-items-end">
              <div class="col-6 col-md-3">
                <label class="form-label">Rango</label>
                <select id="rango" class="form-select">
                  <option value="30">Últimos 30 días</option>
                  <option value="90">Últimos 90 días</option>
                  <option value="365">Último año</option>
                </select>
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">Tipo de gráfico</label>
                <select id="tipo" class="form-select">
                  <option value="bar">Barras</option>
                  <option value="doughnut">Dona</option>
                </select>
              </div>
              <div class="col-12 col-md-3 d-grid">
                <button id="btnAplicar" type="button" class="btn btn-brand">Aplicar</button>
              </div>
            </form>
          </div>
        </div>
      </section>

      <!-- Tarjeta con el gráfico -->
      <section>
        <div class="card border-0 shadow-sm rounded-4">
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between mb-3">
              <h2 class="h6 m-0">Distribución por tipo de transacción</h2>
            </div>

            <!-- Lienzo donde Chart.js dibuja -->
            <div class="p-2">
              <canvas id="grafico" height="110"></canvas>
            </div>

            <!-- Leyenda complementaria -->
            <div class="row text-center mt-3 g-2">
              <div class="col-6 col-md-3"><small class="text-muted d-block">Depósitos</small><span class="fw-semibold" id="nDepositos">0</span></div>
              <div class="col-6 col-md-3"><small class="text-muted d-block">Retiros</small><span class="fw-semibold" id="nRetiros">0</span></div>
              <div class="col-6 col-md-3"><small class="text-muted d-block">Pagos</small><span class="fw-semibold" id="nPagos">0</span></div>
              <div class="col-6 col-md-3"><small class="text-muted d-block">Consultas</small><span class="fw-semibold" id="nConsultas">0</span></div>
            </div>
          </div>
        </div>
      </section>

      <p class="text-muted small mt-3">* Interfaz de demostración. No hay cálculos reales de cuenta.</p>
    </div>
  </main>

  <script>
    // --------------------------------------------------------------------
    // Datos de ejemplo (mock): cantidades por tipo de transacción.
    // --------------------------------------------------------------------
    const datosMock = {
      depositos: 2,
      retiros: 6,
      pagos: 4,
      consultas: 2
    };

    // Colores suaves para mantener coherencia visual
    const colores = {
      depositos: '#22c55e', // verde suave
      retiros:   '#ef4444', // rojo suave
      pagos:     '#f59e0b', // amarillo/ámbar
      consultas: '#3b82f6'  // azul
    };

    // Referencias al DOM
    const ctx = document.getElementById('grafico').getContext('2d');
    const nDepositos = document.getElementById('nDepositos');
    const nRetiros   = document.getElementById('nRetiros');
    const nPagos     = document.getElementById('nPagos');
    const nConsultas = document.getElementById('nConsultas');
    const selTipo    = document.getElementById('tipo');
    const btnAplicar = document.getElementById('btnAplicar');

    // Pinta los totales debajo del gráfico
    function actualizarTotales({depositos, retiros, pagos, consultas}) {
      nDepositos.textContent = depositos;
      nRetiros.textContent   = retiros;
      nPagos.textContent     = pagos;
      nConsultas.textContent = consultas;
    }

    // Construye la configuración base según el tipo de gráfico elegido
    function getConfig(tipo, data) {
      const etiquetas = ['Depósitos', 'Retiros', 'Pagos', 'Consultas'];
      const valores   = [data.depositos, data.retiros, data.pagos, data.consultas];
      const fondos    = [colores.depositos, colores.retiros, colores.pagos, colores.consultas];

      if (tipo === 'doughnut') {
        return {
          type: 'doughnut',
          data: {
            labels: etiquetas,
            datasets: [{
              data: valores,
              backgroundColor: fondos
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'bottom' },
              tooltip: { callbacks: { label: (ctx) => `${ctx.label}: ${ctx.raw}` } }
            },
            cutout: '60%' // agujero central más amplio
          }
        };
      }

      // Default: barras
      return {
        type: 'bar',
        data: {
          labels: etiquetas,
          datasets: [{
            label: 'Cantidad',
            data: valores,
            backgroundColor: fondos,
            borderRadius: 6 // esquinas suaves en las barras
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }, // sin leyenda para mantenerlo limpio
            tooltip: { callbacks: { label: (ctx) => ` ${ctx.raw}` } }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: { precision: 0 } // enteros
            }
          }
        }
      };
    }

    // Crea el gráfico inicial
    let grafico = new Chart(ctx, getConfig('bar', datosMock));
    actualizarTotales(datosMock);

    // Botón "Aplicar": recrea el gráfico según el tipo elegido.
    btnAplicar.addEventListener('click', () => {
      const tipo = selTipo.value;
      grafico.destroy();
      grafico = new Chart(ctx, getConfig(tipo, datosMock));
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
